<!DOCTYPE html>
<html>
<head>
  <title>{{ title }}</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel='stylesheet' href='/stylesheets/style.css' media="screen"/>

  <link rel="shortcut icon" href="/images/app/favicon.ico" type="image/x-icon"/>
  <link rel="apple-touch-icon" href="/images/app/ios-icon.png">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script type="text/javascript">
    $(document).ready(() =>{

      var response = {{& response}};

        if(response.responses.length){
          urlResponse(response.responses);
        }

    });


    function urlResponse(response){

      $.each(response, (i, v) =>{
        var url    = v.url;


        var html = [
          '<div class="row">',
          '<div class="status">',
          'Redirect Status: ' + v.status + ' - <span>' + v.urlType + '</span>',
          '</div>',
          '<div class="url">',
          'URL: ' + url,
          '</div>',
          '</div>'
        ].join('');


        if(v.urlType === 'tracks the click at the block level'){

//          var query  = url.split('?');
//          var params = '';
//
//          if(query[1]){
//            params = query[1].split('&').join('<br />');
//          }

          var params = splitParam(url);
          var imageParams = splitParam(v.imageUrl);

          html = [
            '<div class="row">',
            '<div class="status">',
            'Redirect Status: ' + v.status + ' - <span>' + v.urlType + '</span>',
            '</div>',
            '<div class="url">',
            'URL: ' + url,
            '</div>',
            '<div class="params"><h2>Params:</h2>',
            params,
            '</div>',


            '<div class="imageUrl"><h2>Params:</h2>',
            imageParams,
            '</div>',

            '</div>'
          ].join('');

        }

        $('section').append(html);

      });

    }


    function splitParam(url){
      
      var query  = url.split('?');
      var params = '';

      if(query[1]){
        params = query[1].split('&').join('<br />');
      }
      return params
    }

  </script>

</head>
<body>

<section></section>
<pre>{{ errorMsg }}</pre>

</body>
</html>